{
    "name": "FinalModel_MACRO_Multibranch_CV",
    "run_details": "_cross_validation_MACRO_noFC_MultiBranch_macroES_BS16",
    "n_gpu": 1,
    "arch": {
        "type": "FinalModelMultiBranch",
        "args": {
            "multi_label_training": true,
            "multi_branch_heads": 1,
            "first_conv_reduction_kernel_size": 3,
            "second_conv_reduction_kernel_size": 3,
            "third_conv_reduction_kernel_size": 16,
            "vary_channels_lighter_version": false,
            "discard_FC_before_MH": true,
            "branchNet_gru_units": 24,
            "branchNet_heads": 2
        }
    },
    "data_loader": {
        "type": "ECGDataLoader",
        "cross_valid": {
            "enabled": true,
            "k_fold": 10,
            "data_dir": "data/CinC_CPSC/cross_valid/"
        },
        "args": {
            "data_dir": "data/CinC_CPSC/train/preprocessed/no_sampling/eq_len_72000",
            "batch_size": 16,
            "shuffle": true,
            "validation_split": 0.25,
            "num_workers": 4,
            "pin_memory": false
        },
        "overfit_single_batch": false,
        "test_dir": "data/CinC_CPSC/test/preprocessed/no_sampling/eq_len_72000"
    },
    "optimizer": {
        "type": "Adam",
        "args": {
            "lr": 0.001,
            "weight_decay": 0,
            "amsgrad": false
        }
    },
    "loss": {
        "type": "multi_branch_BCE_with_logits",
        "add_args": {
          "lambda_balance": 1
        }
    },
    "metrics": {
        "sl": {
            "per_iteration": {
                "sk_accuracy": [
                    "log_probs",
                    "logits"
                ]
            },
            "per_epoch": [
                "cpsc_score",
                "weighted_sk_f1",
                "macro_sk_f1"
            ],
            "per_epoch_class_wise": [
                "class_wise_sk_f1"
            ]
        },
        "ml": {
            "per_iteration": {
                "sk_subset_accuracy": [
                    "sigmoid_probs",
                    "logits"
                ]
            },
            "per_epoch": [
                "cpsc_score",
                "weighted_sk_f1",
                "macro_sk_f1"
            ],
            "per_epoch_class_wise": [
                "class_wise_sk_f1"
            ]
        },
        "additional_metrics_args": {
            "sigmoid_probs": false,
            "log_probs": false,
            "logits": true
        }
    },
    "lr_scheduler": {
        "active": false,
        "type": "ReduceLROnPlateau",
        "args": {
            "mode": "max",
            "factor": 0.1,
            "patience": 10,
            "threshold": 0.0001,
            "threshold_mode": "rel"
        }
    },
    "trainer": {
        "epochs": 300,
        "save_dir": "savedVM",
        "save_period": 1,
        "verbosity": 2,
        "monitor": "max val_macro_sk_f1",
        "early_stop": 20,
        "tensorboard": true,
        "try_run": false,
        "profiler_active": false
    }
}